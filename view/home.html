<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PreparAI - Início</title>
    
    <link rel="stylesheet" href="styles/styles.css">
    <link rel="stylesheet" href="styles/styles-home.css">
    <link rel="stylesheet" href="styles/styles-chat.css">
    <link rel="stylesheet" href="styles/styles-timer.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="icon" type="image/png" href="img/book_711189.png">
    <link rel="icon" type="image/png" href="img/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="img/favicon.svg" />
    <link rel="shortcut icon" href="img/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="img/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="PreparAI" />
    <link rel="manifest" href="img/site.webmanifest" />

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@2.4.0/dist/purify.min.js"></script>

    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            },
            startup: {
                typeset: false
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body class="home-page">

    <header id="main-header">
        
        <div class="header-left">
            <nav id="menu-hamburguer">
                <input type="checkbox" id="check">
                <label for="check" class="checkbtn"><i class="fas fa-bars"></i></label>
                <div class="nav-mobile">
                    <a href="historico.html">Histórico/Exames</a>
                    <a href="#">Configurações</a>
                    <a href="#">Ajuda</a>
                </div>
            </nav>
            <img src="img/pd.png" alt="Logo" class="header-logo">
        </div>

        <div class="header-center">
            <div id="navigation-links">
                <a href="home.html" class="active">INÍCIO</a> 
                <a href="simulado.html">SIMULADO</a>
                <a href="redacao.html">REDAÇÃO</a>
                <a href="desempenho.html">DESEMPENHO</a>
            </div>
        </div>

        <div class="header-right">
            <div class="profile-header"> 
                <img src="img/perfil.png" alt="perfil" class="header-perfil">
                
                <div class="dropdown-menu">
                    <a href="#" onclick="alert('Perfil em breve!')">Meu Perfil</a>
                    <a href="#" onclick="logout()" class="logout-link">Sair <i class="fas fa-sign-out-alt"></i></a>
                </div>
                
            </div>
        </div>
    </header>

    <main class="home-container">
        
        <div class="welcome-section">
            <h2 id="msg-bem-vindo">Olá, Estudante!</h2>
            <p id="dash-msg" class="subtitle">Carregando seus dados...</p>
        </div>

        <div class="recommendation-card" id="card-recomendacao" style="display: none;">
            <div class="rec-icon">
                <i class="fas fa-lightbulb"></i>
            </div>
            <div class="rec-content">
                <h3 id="rec-titulo">Analisando seu perfil...</h3>
                <p id="rec-texto">Carregando sugestões personalizadas de estudo baseadas no seu desempenho.</p>
            </div>
        </div>

        <div class="kpi-container">
            <div class="kpi-card">
                <i class="fas fa-book-open"></i>
                <div class="kpi-info">
                    <h3>Simulados</h3>
                    <span id="dash-simulados">0</span>
                </div>
            </div>
            
            <div class="kpi-card">
                <i class="fas fa-pen-fancy"></i>
                <div class="kpi-info">
                    <h3>Redações</h3>
                    <span id="dash-redacoes">0</span>
                </div>
            </div>

            <div class="kpi-card">
                <i class="fas fa-chart-line"></i>
                <div class="kpi-info">
                    <h3>Média Geral</h3>
                    <span id="dash-media">0</span>
                </div>
            </div>
        </div>

        <div class="chat-container-wrapper">
            
            <aside class="chat-sidebar">
                <div class="sidebar-header">
                    <h3>Histórico</h3>
                    <button onclick="criarNovoChat()" class="btn-new-chat" title="Nova Conversa">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                <div id="lista-sessoes" class="sessions-list">
                    <div class="session-item active">Carregando...</div>
                </div>
            </aside>

            <div class="chat-main-area">
                <div class="chat-messages" id="chatMessages"></div>
                
                <div class="chat-input-wrapper">
                    <textarea id="chatInput" class="chat-input" placeholder="Digite sua pergunta..." rows="1"></textarea>
                    <button id="sendBtn" class="send-btn"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>

        </div>
    </main>

    <script src="../controller/api.js"></script>
    <script src="../controller/home_controller.js"></script>
    <script src="../controller/chat.js"></script>
    <script src="../controller/timer.js"></script>
    <script>
        function logout() {
            localStorage.removeItem('usuario');
            window.location.href = "index.html";
        }
    </script>
</body>
</html>